@model CrossTrainingsLab.ViewModel.CountryCityViewModel

@{
    ViewBag.Title = "Index";
}

<div class="container">
    <div class="form-group">
       @if (ViewBag.CountryList!=null)
       {
           @Html.DropDownListFor(m=>m.CountryId, ViewBag.CountryList as SelectList, "---Select Country", new { @class="form-control"})
       }
    </div>
    <div class="form-group">
        @Html.DropDownListFor(m => m.CityId,new SelectList(" "), "---Select City", new { @class = "form-control" })
    </div>
</div>

<script src="/Scripts/jquery-3.3.1.js"></script>
<script src="/Scripts/bootstrap.js"></script>
<script>
    //$(function () {

    //    var countries = [

    //        { "Name": "Pakistan", "Code": 92, "Cities": ["Lahore", "Karachi", "Islamabad"] },
    //        { "Name": "Chaina", "Code": 93, "Cities": ["Bejing", "Shingai", "Kashgar"] },
    //    ];
    //    for (var i = 0; i < countries.length; i++) {
    //        $("#country").append("<option value='" + i + "'>" + countries[i].Name + "(" + countries[i].Code + ")" + "</option>")
    //    }
    //    $("#country").change(function () {
    //        $("#city").html("<option value='-1'>- Select City -</option>")
    //        var index = $(this).select("option:selected").val();
    //        for (var i = 0; i < countries[index].Cities.length; i++) {
    //            $("#city").append("<option value='" + i + "'>" + countries[index].Cities[i] + "</option>")
    //        }

    //    });

    //});

    $(document).ready(function () {
        $("#CountryId").change(function () {
            $.get("/Cas/GetCityList", { CountryId: $("#CountryId").val() }, function (data) {
                $.each(data, function(index, row) {
                    $("#CityId").append("<option='" + row.CityId+ "'>" + row.CityName + "</option>")
                });
            });
        });

    });


</script>